AARRR

数据一致性，涉及正向交易和逆向交易、优惠、会员、评价，
积分对账
权益对账

资损场景：
退会后，身份、权益、积分信息未全部注销
入会、权益和积分未正确发放


下单送积分：
MQ订阅正向交易
单机限流处理，防止大促期间高QPS打崩下游
会员身份信息判断，滤除非会员订单
幂等校验，过滤重复投递的MQ订单数据
是否逆向数据先到
分布式锁，防止积分多线程扣减

扣件可用积分金额
顺序MQ，扣件积分明细

会员平台
会员身份、层级、积分


会员身份表：
会员ID
买家ID
会员邮箱
是否退会
入会时间
退会时间
业务类型：店铺会员、线上线下会员通、美妆会员、母婴会员。。。
入会渠道：会场、店铺。。。
可用积分
层级
层级更新时间
会员身份过期时间
扩展字段，保存信息：nickName、店铺ID、过期积分、会员生日


积分系统：
领域模型

商家：
积分计算：
商家ID
国家标
渠道
数值

积分加倍：
渠道
倍数


积分明细：
积分明细ID
会员ID
渠道：交易、评价、生日月
相关事件ID：订单ID、评论ID..
赚取积分
赚取时间
过期时间




会员身份：












